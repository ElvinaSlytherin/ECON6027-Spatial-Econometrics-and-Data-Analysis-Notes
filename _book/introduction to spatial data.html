<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction to Spatial Data – ECON6027 Spatial Econometrics and Data Analysis Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./introduction to R.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction to spatial data.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Spatial Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ECON6027 Spatial Econometrics and Data Analysis Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction to spatial data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Spatial Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction to R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-spatial-data" id="toc-what-is-spatial-data" class="nav-link active" data-scroll-target="#what-is-spatial-data"><span class="header-section-number">1.1</span> What is Spatial Data?</a></li>
  <li><a href="#key-features-of-spatial-data" id="toc-key-features-of-spatial-data" class="nav-link" data-scroll-target="#key-features-of-spatial-data"><span class="header-section-number">1.2</span> Key Features of Spatial Data</a></li>
  <li><a href="#types-of-spatial-data-theoretical-classification" id="toc-types-of-spatial-data-theoretical-classification" class="nav-link" data-scroll-target="#types-of-spatial-data-theoretical-classification"><span class="header-section-number">1.3</span> Types of Spatial Data: Theoretical Classification</a>
  <ul class="collapse">
  <li><a href="#geospatial-geostatistical-earth-data" id="toc-geospatial-geostatistical-earth-data" class="nav-link" data-scroll-target="#geospatial-geostatistical-earth-data"><span class="header-section-number">1.3.1</span> Geospatial / Geostatistical / Earth Data</a></li>
  <li><a href="#point-patterns" id="toc-point-patterns" class="nav-link" data-scroll-target="#point-patterns"><span class="header-section-number">1.3.2</span> Point Patterns</a></li>
  <li><a href="#areal-lattice-regional-data" id="toc-areal-lattice-regional-data" class="nav-link" data-scroll-target="#areal-lattice-regional-data"><span class="header-section-number">1.3.3</span> Areal / Lattice / Regional Data</a></li>
  </ul></li>
  <li><a href="#types-of-spatial-data-practical-classification" id="toc-types-of-spatial-data-practical-classification" class="nav-link" data-scroll-target="#types-of-spatial-data-practical-classification"><span class="header-section-number">1.4</span> Types of Spatial Data: Practical Classification</a>
  <ul class="collapse">
  <li><a href="#point" id="toc-point" class="nav-link" data-scroll-target="#point"><span class="header-section-number">1.4.1</span> Point</a></li>
  <li><a href="#polyline" id="toc-polyline" class="nav-link" data-scroll-target="#polyline"><span class="header-section-number">1.4.2</span> Polyline</a></li>
  <li><a href="#polygon" id="toc-polygon" class="nav-link" data-scroll-target="#polygon"><span class="header-section-number">1.4.3</span> Polygon</a></li>
  <li><a href="#raster-data" id="toc-raster-data" class="nav-link" data-scroll-target="#raster-data"><span class="header-section-number">1.4.4</span> Raster Data</a></li>
  </ul></li>
  <li><a href="#spatial-data-file-formats" id="toc-spatial-data-file-formats" class="nav-link" data-scroll-target="#spatial-data-file-formats"><span class="header-section-number">1.5</span> Spatial Data File Formats</a>
  <ul class="collapse">
  <li><a href="#esri-shapefile" id="toc-esri-shapefile" class="nav-link" data-scroll-target="#esri-shapefile"><span class="header-section-number">1.5.1</span> ESRI Shapefile</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Spatial Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-is-spatial-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-is-spatial-data"><span class="header-section-number">1.1</span> What is Spatial Data?</h2>
<p>Spatial data consists of positional information, answering the question <strong>“where is it”</strong> (on Earth, body, Sun, moon etc). Many empirical data contain not only information about the attribute of interest (i.e.&nbsp;the response/variable being studied), but also other variables that denote the <strong>geographic location</strong> where the response was observed. In particular, spatial data has a spatial reference: they have <em>(i) coordinates</em> and <em>(ii) a system of reference</em> for those coordinates (aka a coordinate reference system, CRS).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples of spatial data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Locations of volcano peaks on Earth
<ul>
<li>We could list the coordinates for all known volcanoes as pairs of <strong>longitude and latitude</strong> decimal degree with respect to the <strong>prime meridian</strong> of Greenwich and zero latitude at the <strong>equator</strong> (known as the <strong>World Geodetic System</strong> - WGS84).</li>
</ul></li>
<li>Temperature at various residential towns around Singapore
<ul>
<li>We can measure the temperature for these areas around Singapore and make use of the CRS - SVY21.</li>
</ul></li>
<li>Dengue clusters around Singapore
<ul>
<li>Similarly, we can collect data on dengue clusters around Singapore and make use of CRS - SVY21.</li>
</ul></li>
</ul>
<p>To verify if the CRS used in the dataset is accurate, we can refer to the Coordinate Systems Worldwide - <a href="https://epsg.io/" class="uri">https://epsg.io/</a>.</p>
</div>
</div>
</section>
<section id="key-features-of-spatial-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="key-features-of-spatial-data"><span class="header-section-number">1.2</span> Key Features of Spatial Data</h2>
<p>One of the key features of spatial data is the <strong>auto-correlation</strong> (i.e.&nbsp;correlation with itself) of observations of observations in space. Observations in close spatial proximity tend to be more similar than for observations that are more spatially separated. We can understand that <span class="math inline">\(Cor({X_1},{X_2})\)</span> ranges from <span class="math inline">\(-1\)</span> to <span class="math inline">\(1\)</span> and that correlation increases as <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> get closer and closer to each other.</p>
<p>Essentially, spatial data analysis developed concurrently across many disciplines, including geology, geography, and meteorology, as well as other non-traditional statistical areas. This led to the development of various methodologies, from traditional statistical techniques like linear models, response surface theory, and spatial statistics to spatial econometric approaches. The primary challenge today is to effectively combine these diverse tools to suit our specific analytical needs.</p>
</section>
<section id="types-of-spatial-data-theoretical-classification" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="types-of-spatial-data-theoretical-classification"><span class="header-section-number">1.3</span> Types of Spatial Data: Theoretical Classification</h2>
<p>We denote a spatial process in <span class="math inline">\(D\)</span> dimensions as: <span class="math inline">\({Z(s):s\in D \subset R^d}\)</span> where <span class="math inline">\(Z\)</span> is the <strong>observed attribute</strong> (such as pollution, temperature etc.) of location <strong>s</strong>, a <span class="math inline">\((D \times 1)\)</span> vector of coordinates. The spatial data types are distinguished through characteristics of the domain <span class="math inline">\(D\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_pollution.png" class="img-fluid figure-img"></p>
<figcaption>Pollution of Ozone Layer</figcaption>
</figure>
</div>
<section id="geospatial-geostatistical-earth-data" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="geospatial-geostatistical-earth-data"><span class="header-section-number">1.3.1</span> Geospatial / Geostatistical / Earth Data</h3>
<p>Domain <span class="math inline">\(D\)</span> is <strong>continuous</strong> s.t. <span class="math inline">\(Z(s)\)</span> can be observed anywhere in <span class="math inline">\(D\)</span>. This means that between any two sample locations, we can theoretically place an infinite number of other samples. For example, I can measure temperature at multiple locations in the same classroom.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Examples of Geostatistical Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>For example, consider measuring air temperature or PSI value, which at least in theory, can be recorded at any location.</li>
<li>However, we will only observe a finite number of observations (e.g.&nbsp;only taking temperature at Dhoby Ghaut, which is 1 location, making it one sample).
<ul>
<li>In the image above, we would have monitoring stations at some locations and use that data to reconstruct the ozone layer, as compared to taking measurements across the entire region, which is costly and operationally impossible.</li>
</ul></li>
<li>Other examples include ozone layer concentration of a certain material, ground communication levels etc.</li>
</ul>
</div>
</div>
<p>Due to the continuity of <span class="math inline">\(D\)</span>, geostatistical data is also known as <strong>spatial data with continuous variation</strong>. Since the spatial domain is continuous, it cannot be sampled exhaustively and an important task in the analysis is the reconstruction of the surface of the attribute <span class="math inline">\(Z\)</span> over the entire domain, i.e.&nbsp;mapping of <span class="math inline">\(Z(s)\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Continuity is associated with the domain and not the attribute itself (which may be discrete or continuous or even nominal or ordinal). For example, temperature can be measured using a Celsius scale (continuous) or an ordinal scale (discrete).</p>
</div>
</div>
</section>
<section id="point-patterns" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="point-patterns"><span class="header-section-number">1.3.2</span> Point Patterns</h3>
<p>A point pattern has a <strong>random domain</strong> and the attribute itself will be <strong>Degenerate/binary</strong> in nature (i.e.&nbsp;it is either there or not there). If along with the location of an event, if we observe a stochastic attribute, then it is called a <strong>marked</strong> pattern.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of Point Patterns
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Point Patterns:
<ul>
<li>Locations of lightning strikes</li>
<li>Locations at which weed emerge in a garden</li>
<li>Location of lunar craters</li>
</ul></li>
<li>Marked Patterns:
<ul>
<li>Observing the size of the lunar crater along with the location</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="areal-lattice-regional-data" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="areal-lattice-regional-data"><span class="header-section-number">1.3.3</span> Areal / Lattice / Regional Data</h3>
<p>Areal data is spatial data where the <strong>domain</strong> <span class="math inline">\(D\)</span> is <strong>fixed and discrete</strong> (non-random and countable). Spatial locations with areal data are often referred to as <strong>sites</strong> or <strong>areal units</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of such spatial data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Postal codes</li>
<li>GRCs</li>
<li>Planning areas</li>
<li>Remotely sensed data reported by pixels (such as data coming from satellites)</li>
</ul>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_TOT_POP.png" class="img-fluid figure-img"></p>
<figcaption>Total Population of Singapore by Planning Area</figcaption>
</figure>
</div>
<p>As seen in the image above, we would denote <span class="math inline">\(Z\)</span> as total population.</p>
<p>It is important to note that one of the main differences between point data and areal data is that, in practice, areal data are <strong>spatially aggregated</strong> over areal regions. Mathematically, this refers to an integration of a continuous spatial attribute. Essentially, we are only taking 1 observation for the entire planning area.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example of areal data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Yield measures on an agricultural plot</li>
<li>Event counts (such as deaths, crimes, voter turnout, etc.) for various sites (such as postal codes, regions, states, etc.)</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Irregular vs Regular Areal Data
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Areal Unit Type</th>
<th>More Precise Term</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Irregular</td>
<td>Regional data</td>
<td>(No example given)</td>
</tr>
<tr class="even">
<td>Regular</td>
<td>Lattice data</td>
<td>Satellite imagery</td>
</tr>
</tbody>
</table>
<p><strong>Key Feature:</strong> Given the discrete nature of the collection of sites, areal data can be <strong>exhaustive</strong>, which is another differentiating feature compared to point data or geospatial data.</p>
<ul>
<li><strong>Example:</strong> Voter turnout data provides a number for every electoral unit, and the issue of predicting the number for any other area does not arise.</li>
</ul>
</div>
</div>
<section id="modifiable-areal-unit-problem-maup" class="level4" data-number="1.3.3.1">
<h4 data-number="1.3.3.1" class="anchored" data-anchor-id="modifiable-areal-unit-problem-maup"><span class="header-section-number">1.3.3.1</span> Modifiable Areal Unit Problem (MAUP)</h4>
<p>Coined by geographers during the 1970s, the modifiable areal unit problem (MAUP) is one of the most <strong>stubborn problems</strong> in spatial analysis when spatially aggregated data are used. Data tabulated for different spatial scale levels or according to different zonal systems for the same region will not provide consistent analysis results. This means that when we run analysis on a regional vs planning area basis, the results will differ but both results are correct and accurate (even if they result in contrasting conclusions).</p>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-comparison_planning_vs_region-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparison_planning_vs_region-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/W1_planning_area.png" class="img-fluid figure-img" width="898">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comparison_planning_vs_region-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Planning Areas of Singapore
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-comparison_planning_vs_region-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparison_planning_vs_region-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/W1_regions.png" class="img-fluid figure-img" width="894">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comparison_planning_vs_region-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Regions of Singapore
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The statistical methodology to be applied will inherently depend on the type of spatial data that we have. Refer to Chapter 8 for the different statistical techniques covered.</p>
</div>
</div>
</section>
</section>
</section>
<section id="types-of-spatial-data-practical-classification" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="types-of-spatial-data-practical-classification"><span class="header-section-number">1.4</span> Types of Spatial Data: Practical Classification</h2>
<p>Spatial data is classified and contained in software programs such as R, ArcGIS etc. that handle spatial datasets in the following manner:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Types of Spatial Data
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Points</strong></td>
<td style="text-align: left;">A single point location.</td>
<td style="text-align: left;">A GPS reading or a geo-coded address.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lines</strong></td>
<td style="text-align: left;">A set of ordered points connected by straight-line segments.</td>
<td style="text-align: left;">Contour lines, road networks, or river networks.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Polygons</strong></td>
<td style="text-align: left;">An area marked by one or more enclosed lines.</td>
<td style="text-align: left;">Administrative regions, a collection of islands, or electoral districts.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Grids/Raster</strong></td>
<td style="text-align: left;">A collection of rectangular cells organized in a regular lattice.</td>
<td style="text-align: left;">Satellite imagery that registers data on a regular grid.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_practical_data.png" class="img-fluid figure-img"></p>
<figcaption>Types of Spatial Data: Practical Classification</figcaption>
</figure>
</div>
<p>The first three types (points, lines, and polygons), are collectively known as <strong>vector</strong> data. The geographic vector data model is based on observations located within a coordinate reference system (CRS). Observations can represent self-standing features (e.g., the location of a bus stop) or they can be linked together to form more complex geometries such as lines and polygons. Most vector geometries contain only 2-dimensions (3- dimensional CRSs contain an additional <span class="math inline">\(z\)</span> value, e.g.: height above sea level, depth, etc).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_vector_dataset.png" class="img-fluid figure-img"></p>
<figcaption>Vector Dataset Example</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>EPSG:4326 refers to the World Geodetic System, which is our typical longitude and latitude</p>
</div>
</div>
<section id="point" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="point"><span class="header-section-number">1.4.1</span> Point</h3>
<p>A point is composed of <strong>one coordinate pair</strong> representing a specific location in a coordinate system. Points are the most <strong>basic</strong> geometric primitives having <strong>no length or area</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_point.png" class="img-fluid figure-img"></p>
<figcaption>Point</figcaption>
</figure>
</div>
</section>
<section id="polyline" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="polyline"><span class="header-section-number">1.4.2</span> Polyline</h3>
<p>A polyline is composed of a sequence of two or more coordinate pairs called <strong>vertices</strong>. Essentially, when we join 2 or more points, it becomes a polyline. A vertex is defined by coordinate pairs, just like a point, but what differentiates a vertex from a point is its explicitly defined relationship with neighbouring vertices. A vertex is connected to at least one other vertex. Roads and rivers are commonly stored as polylines</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_polyline.png" class="img-fluid figure-img"></p>
<figcaption>Polyline</figcaption>
</figure>
</div>
</section>
<section id="polygon" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="polygon"><span class="header-section-number">1.4.3</span> Polygon</h3>
<p>A polygon is composed of three or more line segments whose starting and ending coordinate pairs are the same. Sometimes we will see the words <em>lattice</em> or <em>areal unit</em> used in lieu of <em>polygon</em>. The <strong>area that a polygon encloses is explicitly defined</strong>. If it isn’t, then we are working with a polyline feature. If this does not seem intuitive, we can think of three connected lines defining a triangle: they can represent three connected road segments (thus polyline features), or they can represent the grassy strip enclosed by the connected roads (in which case an ‘inside’ is implied thus defining a polygon).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_polygon.png" class="img-fluid figure-img"></p>
<figcaption>Polygon</figcaption>
</figure>
</div>
</section>
<section id="raster-data" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="raster-data"><span class="header-section-number">1.4.4</span> Raster Data</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_raster_example.png" class="img-fluid figure-img"></p>
<figcaption>Raster Dataset Example</figcaption>
</figure>
</div>
<p>The geographic raster data model usually consists of a raster header and a matrix (with rows and columns) representing <strong>equally spaced cells</strong> (often also called pixels or tiles). The <strong>raster header defines the coordinate reference system</strong>, the extent and the origin. The header defines the extent via the number of columns, the number of rows and the cell size resolution. Starting from the origin, we can access and modify each single cell by either using the <strong>cell ID</strong> or by specifying the rows and columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_raster_data.png" class="img-fluid figure-img"></p>
<figcaption>Zoom into Raster Data</figcaption>
</figure>
</div>
<p>This matrix representation avoids storing explicitly the coordinates for the four corner points (in fact it only stores one coordinate, namely the origin) of each cell corner as would be the case for rectangular vector polygons. This means that we are referencing our data with regards to the origin. This and map algebra makes raster processing much more efficient and faster than vector data processing (think of satellite imaging). In contrast to vector data, the cell of one raster layer can only hold a single value. The value might be numeric or categorical. Raster datasets are commonly used for representing and managing imagery, surface temperatures, digital elevation models, and numerous other entities.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_raster_real.png" class="img-fluid figure-img"></p>
<figcaption>Raster Data in the Real World</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Working with raster data tends to create more pixelated maps, as compared to vector maps</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_vector_raster.png" class="img-fluid figure-img"></p>
<figcaption>Vector vs Raster Data</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vector Data vs.&nbsp;Raster Data
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: left;">Vector Data</th>
<th style="text-align: left;">Raster Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Structure</strong></td>
<td style="text-align: left;">Has discrete, well-defined borders and a <strong>high level of precision</strong>.</td>
<td style="text-align: left;">Divides a surface into a regular grid of cells. Raster datasets are the basis of background images used in <strong>web-mapping</strong> and have been a vital source of geographic data since the origins of <strong>aerial photography and satellite-based remote sensing devices</strong>. Rasters aggregate spatially specific features to a given resolution.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Common Use</strong></td>
<td style="text-align: left;">Tends to dominate the social sciences; human settlements have discrete borders.</td>
<td style="text-align: left;">Dominates environmental sciences due to reliance on remote sensing data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Examples</strong></td>
<td style="text-align: left;">Geo-coded addresses, roads, or administrative regions.</td>
<td style="text-align: left;">Satellite imagery, aerial photography, or elevation models.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Flexibility</strong></td>
<td style="text-align: left;">There is <strong>much overlap</strong> in some fields and raster and vector datasets can be used together. Possible to <strong>convert between vector and raster formats</strong>. Ecologists and demographers commonly use both.</td>
<td style="text-align: left;">There is <strong>much overlap</strong> in some fields and raster and vector datasets can be used together. Possible to <strong>convert between raster and vector formats</strong>. Ecologists and demographers commonly use both.</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="spatial-data-file-formats" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="spatial-data-file-formats"><span class="header-section-number">1.5</span> Spatial Data File Formats</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data File Formats
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Vector Data File Formats</th>
<th style="text-align: left;">Raster Data File Formats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">• ESRI Shapefile: Popular format consisting of at least three files.</td>
<td style="text-align: left;">• GeoTiff: Popular raster format. A TIFF file containing additional spatial metadata.</td>
</tr>
<tr class="even">
<td style="text-align: left;">• GeoJSON</td>
<td style="text-align: left;">• File Geodatabase</td>
</tr>
<tr class="odd">
<td style="text-align: left;">• KML: XML-based format for spatial visualization, developed for use with Google Earth.</td>
<td style="text-align: left;">• Arc ASCII: Text format where the first six lines represent the raster header, followed by the raster cell values arranged in rows and columns.</td>
</tr>
<tr class="even">
<td style="text-align: left;">• GPX: XML schema created for exchange of GPS data.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">• File Geodatabase</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">• GeoPackage</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="esri-shapefile" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="esri-shapefile"><span class="header-section-number">1.5.1</span> ESRI Shapefile</h3>
<p>A <strong>shapefile</strong> is a file-based data format native to ArcView 3.x software (a much older version of ArcMap). It stores a collection of features that have the same geometry type (point, line, or polygon), the same attributes, and a common spatial extent (scale). Despite its name, a “single” shapefile is composed of at least three files, and as many as eight. Each file that makes up a “shapefile” has a common filename but different extension type. Each file has a specific role in defining a shapefile.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/W1_ERSI_shapefile.png" class="img-fluid figure-img"></p>
<figcaption>ERSI Shapefile</figcaption>
</figure>
</div>
<p>With this understanding of spatial data and the file formats that we will be working with in R, we can now take a closer look as to how to analyze spatial data using the <code>sf()</code> package.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-sp_vignette" class="csl-entry" role="listitem">
Bivand, Roger S., Edzer Pebesma, and Virgilio Gomez-Rubio. n.d. <span>“Sp: Classes and Methods for Spatial Data.”</span> Accessed August 31, 2025. <a href="https://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf">https://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf</a>.
</div>
<div id="ref-brunsdon_comber" class="csl-entry" role="listitem">
Brunsdon, Chris, and Lex Comber. n.d. <span>“An Introduction to Sp and Sf: The Sf Revolution.”</span> Accessed August 31, 2025. <a href="https://bookdown.org/lexcomber/brunsdoncomber2e/Ch3.html">https://bookdown.org/lexcomber/brunsdoncomber2e/Ch3.html</a>.
</div>
<div id="ref-epsg_io" class="csl-entry" role="listitem">
<span>“Coordinate Systems Worldwide.”</span> n.d. Accessed August 31, 2025. <a href="https://epsg.io">https://epsg.io</a>.
</div>
<div id="ref-mgimond_feature" class="csl-entry" role="listitem">
Gimond, M. n.d. <span>“Feature Representation.”</span> Accessed August 31, 2025. <a href="https://mgimond.github.io/Spatial/feature-representation.html">https://mgimond.github.io/Spatial/feature-representation.html</a>.
</div>
<div id="ref-geocompr_class" class="csl-entry" role="listitem">
Lovelace, Robin. n.d. <span>“Spatial Classes.”</span> Accessed August 31, 2025. <a href="https://geocompr.robinlovelace.net/spatial-class.html">https://geocompr.robinlovelace.net/spatial-class.html</a>.
</div>
<div id="ref-lovelace2022geocomputation" class="csl-entry" role="listitem">
Lovelace, Robin, Jakub Nowosad, and Jannes Muenchow. 2022. <em>Geocomputation with r</em>. <a href="https://geocompr.robinlovelace.net">https://geocompr.robinlovelace.net</a>.
</div>
<div id="ref-schabenberger2005statistical" class="csl-entry" role="listitem">
Schabenberger, Oliver, and Carol A. Gotway. 2005. <em>Statistical Methods for Spatial Data Analysis</em>. 1st ed. CRC Press.
</div>
<div id="ref-sf_vignette" class="csl-entry" role="listitem">
<span>“Simple Features for r (Sf) Vignette.”</span> n.d. Accessed August 31, 2025. <a href="https://r-spatial.github.io/sf/articles/">https://r-spatial.github.io/sf/articles/</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./introduction to R.html" class="pagination-link" aria-label="Introduction to R">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>